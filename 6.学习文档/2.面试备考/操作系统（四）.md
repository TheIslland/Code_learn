# 操作系统（四）

## 1.什么是内存碎片？

> 所谓内存碎片，就是有一部分内存不能够分配给程序使用，因为它们以碎片的方式存在。内存碎片可以分两种，内部碎片和外部碎片:
>
> * 内部碎片是分配器分配的内存大于程序申请的内存
> * 外部碎片是内存块太小，无法分配给程序使用。

## 2.说说你知道的cache置换算法

* 最优页面置换

  它需要知道以后要被用到的页，然后将不会被用到的页换出内存；如果所有页都会被用到，就把需要使用时间离现在最长的页换出，以尽量使不好的情况晚发生。这种方法能使系统获得最佳性能，但是，它是不可能实现的......因为当前无法获知以后哪些页要被用到。不过最优算法还是能够作为其他算法优秀程度的衡量。

  ​	

* FIFO（First In First Out）

FIFO算法的思想很简单，就是置换出当前已经待在内存里时间最长的那个页。FIFO算法的运行速度很快，不需要考虑其他的因素，需要的开销很少。但是正是由于没有考虑页面的重用性的问题，FIFO算法很容易将重要的页换出内存。

* LRU（Least Recently Used）

        最近最少使用页面置换算法，是为虚拟页式存储管理服务的，近似于最优置换算法。该算法在发生缺页中断时，替换掉最近一段时间内最久没有使用过的页面。LRU算法的缺点在于实现方法的不足：效率高的硬件算法通常在大多数机器上无法运行，而软件算法则开销太大。

  （4）NRU（Not Recently Used）

        最近未被使用页面置换算法，性能不是最优，又称为近似的LRU算法。每个页面有两个位：R位（标识最近是否被访问）和M位（标识最近是否被修改），初始时均为0。一旦因为访问发生缺页中断，则设置R位为1；一旦因为修改发生缺页中断，则设置M位为1。此外R随着时钟周期被定期地清零，以区别最近是否被访问，不把M清零是为了决定是否写回磁盘。当发生缺页中断时，将页面分为四类：

  第0类：R=0，M=0；

  第1类：R=0，M=1；

  第2类：R=1，M=0；

  第3类：R=1，M=1；

  操作系统从类编号最小的页面中选择一个并置换掉。


## 3.虚拟地址、逻辑地址、线性地址、物理地址分别是什么？

虚拟地址：指的是由程序产生的由段选择符和段内偏移地址两个部分组成的地址。为什么叫它是虚拟的地址呢？因为这两部分组成的地址并没有直接访问物理内存，而是要通过分段地址的变换机构处理或映射后才会对应到相应的物理内存地址。

逻辑地址：指由程序产生的与段相关的偏移地址部分。不过有些资料是直接把逻辑地址当成虚拟地址，两者并没有明确的界限。

线性地址：指的是虚拟地址到物理地址变换之间的中间层，是处理器可寻指的内存空间（称为线性地址空间）中的地址。程序代码会产生逻辑地址，或者说是段中的偏移地址，加上相应段的基地址就生成了一个线性地址。如果启用了分页机制，那么线性地址可以再经过变换产生物理地址。若是没有采用分页机制，那么线性地址就是物理地址。

物理地址：指的是现在CPU外部地址总线上的寻址物理内存的地址信号，是地址变换的最终结果。