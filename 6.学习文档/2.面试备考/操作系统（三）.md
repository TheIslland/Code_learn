# 操作系统（三）

## 1.为什么主流系统处理死锁时都采用了鸵鸟策略？

* **什么是鸵鸟算法？**

  当你对某一件事情没有一个很好的解决方法时，那就忽略它，就像鸵鸟面对危险时会把它深埋在沙砾中，装作看不到。这样的算法称为“鸵鸟算法“。当死锁真正发生且影响系统正常运行时，手动干预—重新启动。

* **为什么解决死锁采取鸵鸟策略？**

  当系统发生死锁时不会对用户造成多大影响，或系统很少发生死锁的场合采用允许死锁发生的鸵鸟算法，这样一来可能开销比不允许发生死锁及检测和解除死锁的小。如果死锁很长时间才发生一次，而系统每周都会因硬件故障、编译器错误或操作系统错误而崩溃一次，那么大多数工程师不会以性能损失或者易用性损失的代价来设计较为复杂的死锁解决策略，来消除死锁。所以大多数主流操作系统，处理死锁问题的办法仅仅是忽略它。综上所述，因为出现死锁的概率很小，并且出现之后处理死锁会花费很大的代价，还不如不做处理，所以鸵鸟算法，是平衡性能和复杂性而选择的一种方法。

## 2.内存管理有几种办法？

*  块式管理：把主存分为一块一块的，当所需的程序片段不再主存时就分配一块主存空间，把程序加载入主存，就算所需的程序片段只有几个字节也只能把这一块都分给他，造成很大的浪费，但易于管理。

*  页式管理：把主存分为一页一页的，每一页的空间要比一块小很多，显然这种分法的空间利用率要比块式管理高很多。

*  段式管理：把主存分为一段一段的，每一段的空间要比一页小很多，这种方法在空间利用率上比业式管理高很多，但有另外一个缺点：一个程序片段可能会被分为几十段，这样很多时间就会被浪费在计算每一段的物理地址上。

*  段页式管理：结合了段式和业式的优点。把主存先分为若干段，每个段又分成若干业。

段业式管理每取一数据要访问3次内存：

第一次是由段表地址寄存器得段表始址后访问段表，由此取出对应段的页表在内存中的地址。

第二次则是访问页表得到所要访问的物理地址。

第三次才能访问真正需要访问的物理单元。

## 3.什么时虚拟内存？

* **虚拟内存的定义**

  **虚拟内存** 使得应用程序认为它拥有连续的可用的内存（一个连续完整的地址空间），而实际上，它通常是被分隔成多个物理内存碎片，还有部分暂时存储在外部磁盘存储器上，在需要时进行数据交换。与没有使用虚拟内存技术的系统相比，使用这种技术的系统使得大型程序的编写变得更容易，对真正的物理内存（例如RAM）的使用也更有效率。目前，大多数操作系统都使用了虚拟内存，如Windows家族的“虚拟内存”；Linux的“交换空间”等。

* **局部性原理**

  局部性原理表现在以下两个方面： 

  1）时间局部性：如果程序中的某条指令一旦执行，不久以后该指令可能再次执行；如果某数据被访问过，不久以后该数据可能再次被访问。产生时间局部性的典型原因，是由于在程序中存在着大量的循环操作。 

  2）空间局部性：一旦程序访问了某个存储单元，在不久之后，其附近的存储单元也将被访问，即程序在一段时间内所访问的地址，可能集中在一定的范围之内，这是因为指令通常是顺序存放、顺序执行的，数据也一般是以向量、数组、表等形式簇聚存储的。 

  

  时间局部性是通过将近来使用的指令和数据保存到高速缓存存储器中，并使用高速缓存的层次结构实现。空间局部性通常是使用较大的高速缓存，并将预取机制集成到高速缓存控制逻辑中实现。虚拟内存技术实际上就是建立了 “内存一外存”的两级存储器的结构，利用局部性原理实现髙速缓存。


* **虚拟存储器的定义和特征**

  基于局部性原理，在程序装入时，可以将程序的一部分装入内存，而将其余部分留在外存，就可以启动程序执行。在程序执行过程中，当所访问的信息不在内存时，由操作系统将所需要的部分调入内存,然后继续执行程序。另一方面，操作系统将内存中暂时不使用的内容换出到外存上，从而腾出空间存放将要调入内存的信息。这样，系统好像为用户提供了一个比实际内存大得多的存储器，称为虚拟存储器。 

  

  之所以将其称为虚拟存储器，是因为这种存储器实际上并不存在，只是由于系统提供了部分装入、请求调入和置换功能后（对用户完全透明），给用户的感觉是好像存在一个比实际物理内存大得多的存储器。虚拟存储器的大小由计算机的地址结构决定，并非是内存和外存的简单相加。虚拟存储器有以下三个主要特征： 

  1）多次性，是指无需在作业运行时一次性地全部装入内存，而是允许被分成多次调入内存运行。 

  2）对换性，是指无需在作业运行时一直常驻内存，而是允许在作业的运行过程中，进行换进和换出。 

  3）虚拟性，是指从逻辑上扩充内存的容量，使用户所看到的内存容量，远大于实际的内存容量。

* **虚拟内存技术的实现**

  虚拟内存中，允许将一个作业分多次调入内存。釆用连续分配方式时，会使相当一部分内存空间都处于暂时或“永久”的空闲状态，造成内存资源的严重浪费，而且也无法从逻辑上扩大内存容量。因此，虚拟内存的实需要建立在离散分配的内存管理方式的基础上。虚拟内存的实现有以下三种方式： 

  1）请求分页存储管理。 

  2）请求分段存储管理。 

  3）请求段页式存储管理。 

  

  不管哪种方式，都需要有一定的硬件支持。一般需要的支持有以下几个方面： 

  1）一定容量的内存和外存。 

  2）页表机制（或段表机制），作为主要的数据结构。 

  3）中断机构，当用户程序要访问的部分尚未调入内存，则产生中断。 

  4）地址变换机构，逻辑地址到物理地址的变换。